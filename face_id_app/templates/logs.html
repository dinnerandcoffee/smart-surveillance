<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>인식 로그</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <header>
    <h1>인식 로그</h1>
    <nav>
      <a href="/">모니터</a>
      <a href="/register">등록</a>
    </nav>
  </header>

  <main>
    <section class="form-card">
      <h2>필터</h2>
      <form method="get">
        <label>
          이름
          <input type="text" name="name" value="{{ request.args.get('name','') }}">
        </label>
        <label>
          구분
          <select name="role">
            <option value="">전체</option>
            <option value="employee" {% if request.args.get('role') == 'employee' %}selected{% endif %}>직원</option>
            <option value="patient" {% if request.args.get('role') == 'patient' %}selected{% endif %}>환자</option>
          </select>
        </label>
        <label>
          시작일시
          <input type="datetime-local" name="start" value="{{ request.args.get('start','') }}">
        </label>
        <label>
          종료일시
          <input type="datetime-local" name="end" value="{{ request.args.get('end','') }}">
        </label>
        <button type="submit">조회</button>
      </form>
    </section>

    <section class="table-card">
      <h2>최근 기록</h2>
      <table>
        <thead>
          <tr>
            <th>이름</th>
            <th>구분</th>
            <th>유사도</th>
            <th>캡처 경로</th>
            <th>시각</th>
          </tr>
        </thead>
        <tbody>
          {% for row in rows %}
          <tr>
            <td>{{ row.name }}</td>
            <td>{{ '직원' if row.role == 'employee' else '환자' }}</td>
            <td>{{ '%.3f'|format(row.similarity) }}</td>
            <td>{{ row.image_path or '' }}</td>
            <td>{{ row.seen_at }}</td>
          </tr>
          {% else %}
          <tr>
            <td colspan="5">기록이 없습니다.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
  </main>
</body>
</html>
